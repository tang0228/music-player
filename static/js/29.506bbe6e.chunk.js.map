{"version":3,"sources":["assets/loading.svg","pages/Album/AlbumList/index.module.less","pages/Album/AlbumList/item.module.less","services/album.js","pages/Album/AlbumList/Item.jsx","pages/Album/AlbumList/index.jsx"],"names":["module","exports","a","limit","offset","area","ins","get","params","res","connect","state","curSongId","dispatch","setCurSongId","setCurSongIdAction","addSongs","addSongListAction","props","className","style","to","id","height","debounce","placeholder","width","src","loadingUrl","blurPicUrl","alt","onClick","getAlbum","then","code","Toast","success","content","duration","list","songs","map","s","url","song","bind","name","artist","navs","text","target","AlbumList","useState","albums","setAlbums","total","setTotal","setList","loading","setLoading","page","setPage","location","useLocation","query_area","qs","parse","search","useEffect","getAlbumNewest","splice","err","console","log","error","getAlbumList","al","n","i","currentPage","onPageChange","pageSize","spinning","tip","size","position","top","left","transform","zIndex"],"mappings":"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","file":"static/js/29.506bbe6e.chunk.js","sourcesContent":["export default __webpack_public_path__ + \"static/media/loading.4c0ea1e7.svg\";","// extracted by mini-css-extract-plugin\nmodule.exports = {\"album-list\":\"index_album-list__6OFJv\"};","// extracted by mini-css-extract-plugin\nmodule.exports = {\"album-item\":\"item_album-item__3e6iz\"};","import ins from \"./request\";\r\n\r\n// 获取新碟列表\r\nexport async function getAlbumList({ limit, offset, area }) {\r\n    const res = await ins.get(\"/album/new\", {\r\n        params: {\r\n            limit, offset, area\r\n        }\r\n    });\r\n    return res;\r\n}","import React from 'react';\r\nimport LazyLoad from \"react-lazyload\";\r\nimport { Link } from \"react-router-dom\";\r\nimport style from \"./item.module.less\";\r\nimport loadingUrl from \"@/assets/loading.svg\";\r\nimport { getAlbum } from \"@/services/apis\";\r\nimport { addSongListAction } from \"@/store/actions/song\";\r\nimport { setCurSongIdAction } from \"@/store/actions/curSongId\";\r\nimport { connect } from \"react-redux\";\r\nimport { Toast } from \"@douyinfe/semi-ui\";\r\n\r\nconst mapStateToProps = (state) => {\r\n    return {\r\n        curSongId: state.curSongId,\r\n    };\r\n};\r\n\r\nconst mapDispatchToProps = (dispatch) => {\r\n    return {\r\n        setCurSongId: (...args) => dispatch(setCurSongIdAction(...args)),\r\n        addSongs: (...args) => dispatch(addSongListAction(...args))\r\n    };\r\n};\r\n\r\nfunction Item(props) {\r\n    const { setCurSongId, addSongs } = props;\r\n    // 添加新碟到播放列表\r\n    const addSongList = (id) => {\r\n        getAlbum({ id }).then(res => {\r\n            if (res.code === 200) {\r\n                Toast.success({\r\n                    content: \"成功添加新碟到播放列表\",\r\n                    duration: 2,\r\n                });\r\n                const list = res.songs.map(s => ({\r\n                    id: s.id,\r\n                    url: \"https://music.163.com/song/media/outer/url?id=\" + s.id +'.mp3',\r\n                    song: s\r\n                }));\r\n                addSongs(list);\r\n                setCurSongId(list[0].id);\r\n            }\r\n        })\r\n    }\r\n    return (\r\n        <div className={style[\"album-item\"]} key={props.id}>\r\n            <div className=\"album-img\">\r\n                <Link to={'/find/album?id=' + props.id}>\r\n                    <LazyLoad height={130} debounce={500} placeholder={<img width=\"100%\" height=\"100%\" src={loadingUrl} />}>\r\n                        <img src={props.blurPicUrl} alt=\"\" />\r\n                    </LazyLoad>\r\n                    <span className='al-mask'></span>\r\n                </Link>\r\n                <i className=\"icon-album-play\" onClick={addSongList.bind(null, props.id)}></i>\r\n            </div>\r\n            <Link to={'/find/album?id=' + props.id} className=\"album-name\">{props.name}</Link>\r\n            <Link to={'/find/artist?id=' + props.artist.id} className=\"singer-name\">{props.artist.name}</Link>\r\n        </div>\r\n    )\r\n}\r\n\r\nexport default connect(mapStateToProps, mapDispatchToProps)(Item);\r\n","import React, { useEffect, useState } from 'react';\r\nimport style from \"./index.module.less\";\r\nimport { getAlbumList } from '../../../services/album';\r\nimport { getAlbumNewest } from \"../../../services/apis\";\r\nimport { Link, useLocation } from \"react-router-dom\";\r\nimport { Pagination, Spin, Toast } from \"@douyinfe/semi-ui\";\r\nimport Item from \"./Item\";\r\nimport qs from \"query-string\";\r\n\r\nconst navs = [\r\n    { text: \"全部\", target: \"ALL\" },\r\n    { text: \"华语\", target: \"ZH\" },\r\n    { text: \"欧美\", target: \"EA\" },\r\n    { text: \"韩国\", target: \"KR\" },\r\n    { text: \"日本\", target: \"JP\" },\r\n];\r\n\r\nexport default function AlbumList() {\r\n    const [albums, setAlbums] = useState([]); // 新碟\r\n    const [total, setTotal] = useState(0);\r\n    const [list, setList] = useState([]);\r\n    const [loading, setLoading] = useState(false);\r\n    const [page, setPage] = useState(1);\r\n    const location = useLocation();\r\n    let query_area = qs.parse(location.search).area || 'ALL';\r\n    // 获取新碟\r\n    useEffect(() => {\r\n        getAlbumNewest().then(res => {\r\n            if (res.code === 200) {\r\n                setAlbums(res.albums.splice(0, 10));\r\n            }\r\n        }, err => {\r\n            console.log(err, 123)\r\n            Toast.error({\r\n                content: err,\r\n                duration: 2\r\n            })\r\n        })\r\n        return () => {\r\n        }\r\n    }, []);\r\n\r\n    // 获取分类光碟列表\r\n    useEffect(() => {\r\n        setLoading(true)\r\n        getAlbumList({\r\n            limit: 35,\r\n            offset: (page - 1) * 35,\r\n            area: query_area,\r\n        }).then(res => {\r\n            if (res.code === 200) {\r\n                setTotal(res.total);\r\n                setList(res.albums);\r\n                setLoading(false);\r\n            }\r\n        }, err => {\r\n            setLoading(false);\r\n            Toast.error({\r\n                content: err,\r\n                duration: 2\r\n            })\r\n        })\r\n        return () => {\r\n        }\r\n    }, [page, query_area]);\r\n\r\n    // 页码变化\r\n    const handlePageChange = page => {\r\n        setPage(page);\r\n    }\r\n\r\n    return (\r\n        <div className={style['album-list']}>\r\n            <div className=\"header\">\r\n                <div className=\"title\">热门新碟</div>\r\n            </div>\r\n            <div className=\"album-wrapper\">\r\n                {albums ? albums.map(al => <Item key={al.id} {...al} />) : null}\r\n            </div>\r\n            <div className=\"header\">\r\n                <div className=\"title\">全部新碟</div>\r\n                <div className=\"cat-nav\">\r\n                    {navs.map((n, i) => <Link key={n.target} to={\"/find/album/list?area=\" + n.target} className='item'>{n.text} {i < 4 ? <span className='line'>|</span> : ''}</Link>)}\r\n                </div>\r\n            </div>\r\n            <div className=\"album-wrapper\">\r\n                {list ? list.map(al => <Item key={al.id} {...al} />) : null}\r\n            </div>\r\n            {total > 0 ? (\r\n                <div className=\"pagination-wrapper\">\r\n                    <Pagination\r\n                        total={total}\r\n                        currentPage={page}\r\n                        onPageChange={handlePageChange}\r\n                        pageSize={35}\r\n                    ></Pagination>\r\n                </div>\r\n            ) : null}\r\n            <Spin\r\n                spinning={loading}\r\n                tip=\"loading...\"\r\n                size=\"large\"\r\n                style={{\r\n                    position: \"fixed\",\r\n                    top: \"50%\",\r\n                    left: \"50%\",\r\n                    transform: \"translate(-50%, -50%)\",\r\n                    zIndex: \"9999\",\r\n                }}\r\n            ></Spin>\r\n        </div >\r\n    )\r\n}\r\n"],"sourceRoot":""}