{"version":3,"sources":["pages/MyMusic/myMusic.module.less","pages/MyMusic/item.module.less","services/playlist.js","pages/MyMusic/Item.jsx","pages/MyMusic/Left.jsx","pages/MyMusic/MyMusic.jsx"],"names":["module","exports","delPlayList","a","id","ins","post","res","name","Item","props","title","list","showBtn","showEdit","userId","useState","open","setOpen","visible","setVisible","setName","del","code","Toast","success","content","onConfirm","className","style","onClick","length","map","l","i","to","src","coverImgUrl","alt","trackCount","creator","nickname","bind","onOk","createPlayList","then","create","onCancel","mask","placeholder","value","onChange","val","Left","playList","likePlayList","connect","state","user","location","useLocation","history","useHistory","qs","parse","search","detail","setDetail","loading","setLoading","setPlayList","setLikePlayList","getList","getUserPlayList","uid","playlist","filter","p","replace","useEffect","getPlayListDetail","handle","DetailLeft","spinning","tip","size","position","top","left","transform","zIndex"],"mappings":"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","file":"static/js/30.cdbea715.chunk.js","sourcesContent":["// extracted by mini-css-extract-plugin\nmodule.exports = {\"my-music\":\"myMusic_my-music__2nt73\"};","// extracted by mini-css-extract-plugin\nmodule.exports = {\"left-item\":\"item_left-item__3oR3v\"};","import ins from \"./request\"\r\n\r\n/**\r\n * 删除歌单\r\n * @param {*} param 歌单id\r\n * @returns \r\n */\r\nexport async function delPlayList( {id}) {\r\n    const res = await ins.post('/playlist/delete', {\r\n        id\r\n    });\r\n    return res;\r\n}\r\n\r\n/**\r\n * 创建歌单\r\n * @param {*} param 歌单名称\r\n * @returns \r\n */\r\nexport async function createPlayList( {name}) {\r\n    const res = await ins.post('/playlist/create', {\r\n        name\r\n    });\r\n    return res;\r\n}","import React, { useState } from 'react'\r\nimport style from \"./item.module.less\"\r\nimport { delPlayList, createPlayList } from \"@/services/playlist\"\r\nimport { Link } from \"react-router-dom\"\r\nimport { Toast, Popconfirm, Modal, Input } from \"@douyinfe/semi-ui\"\r\n\r\nexport default function Item(props) {\r\n    const { title, list, showBtn, id, showEdit = true, userId } = props;\r\n    const [open, setOpen] = useState(true);\r\n    const [visible, setVisible] = useState(false);\r\n    const [name, setName] = useState(\"\");\r\n\r\n\r\n    const handleClick = () => {\r\n        setOpen(!open)\r\n    }\r\n\r\n    // 删除歌单\r\n    const del = async id => {\r\n        const res = await delPlayList({ id });\r\n        if (res.code === 200) {\r\n            props.del && props.del();\r\n            Toast.success({\r\n                content: \"删除成功\",\r\n            })\r\n        }\r\n    }\r\n\r\n    const onConfirm = id => {\r\n        del(id);\r\n    }\r\n\r\n    const handleOk = () => {\r\n        createPlayList({ name }).then(res => {\r\n            if (res.code === 200) {\r\n                props.create && props.create();\r\n                Toast.success({\r\n                    content: \"创建成功\",\r\n                })\r\n            }\r\n        })\r\n        setVisible(false);\r\n        setName(\"\");\r\n    }\r\n\r\n    const handleCancel = () => {\r\n        setVisible(false);\r\n        setName(\"\");\r\n    }\r\n\r\n    const handleChange = (val) => {\r\n        setName(val);\r\n    }\r\n\r\n    return (\r\n        <div className={style[\"left-item\"]}>\r\n            <div className=\"item-header\">\r\n                <span className=\"wrap\" onClick={handleClick}>\r\n                    <i className={open ? \"icon icon-arrow-down\" : \"icon icon-arrow-left\"}></i>\r\n                    <span className=\"text\">{title}（{list.length}）</span>\r\n                </span>\r\n                {showBtn ? <span className=\"add-btn\" onClick={() => {\r\n                    setVisible(true);\r\n                }}><i>新建</i></span> : null}\r\n            </div>\r\n            {open ? <ul className=\"item-list\">\r\n                {list.map((l, i) => <li key={l.id} className={l.id == id ? 'list-item active' : 'list-item'}>\r\n                    <Link to={'/myMusic?id=' + l.id} className=\"wrap\">\r\n                        <img src={l.coverImgUrl} alt=\"\" />\r\n                        <div className=\"info\">\r\n                            <p className=\"name ell\">{l.name}</p>\r\n                            <p className=\"num ell\">{l.trackCount}首 by {l.creator.nickname}</p>\r\n                        </div>\r\n                    </Link>\r\n                    {(userId == l.creator.userId && i !== 0) || userId != l.creator.userId ? <span className=\"options\">\r\n                        {showEdit ? <i className=\"icon-edit icon\"></i> : null}\r\n                        <Popconfirm\r\n                            title=\"确定删除歌单？\"\r\n                            onConfirm={onConfirm.bind(null, l.id)}\r\n                        >\r\n                            <i className=\"icon-del icon\" ></i>\r\n                        </Popconfirm>\r\n                    </span> : null}\r\n                </li>)}\r\n            </ul> : null}\r\n            <Modal\r\n                title=\"新建歌单\"\r\n                visible={visible}\r\n                onOk={handleOk}\r\n                onCancel={handleCancel}\r\n                mask={false}\r\n            >\r\n                <Input placeholder='请输入新建歌单名称' value={name} onChange={handleChange}></Input>\r\n            </Modal>\r\n        </div>\r\n    )\r\n}\r\n","import React from 'react'\r\nimport style from \"./left.module.less\"\r\nimport Item from \"./Item\"\r\n\r\nfunction Left(props) {\r\n    const { id, playList, likePlayList, userId } = props;\r\n\r\n    return (\r\n        <div className={style['left']}>\r\n            <Item userId={userId} list={playList} title=\"创建的歌单\" showBtn={true} id={id} del={() => {\r\n                props.del && props.del();\r\n            }} create={() => {\r\n                props.create && props.create();\r\n            }} />\r\n            {likePlayList.length ? <Item list={likePlayList} title=\"收藏的歌单\" showBtn={false} del={() => {\r\n                props.del && props.del();\r\n            }} showEdit={false} /> : null}\r\n        </div>\r\n    )\r\n}\r\n\r\nexport default Left;","import React, { useState, useEffect } from 'react'\r\nimport style from \"./myMusic.module.less\"\r\nimport Left from \"./Left\"\r\nimport DetailLeft from '../Find/modules/playListDetail/DetailLeft'\r\nimport qs from \"query-string\"\r\nimport { getUserPlayList, getPlayListDetail } from \"@/services/apis\"\r\nimport { useLocation, useHistory } from \"react-router-dom\"\r\nimport { Spin } from \"@douyinfe/semi-ui\";\r\nimport { connect } from \"react-redux\"\r\n\r\nconst mapStateToProps = (state) => {\r\n    return {\r\n        user: state.user\r\n    }\r\n};\r\n\r\nfunction MyMusic(props) {\r\n    const { user } = props;\r\n    const location = useLocation();\r\n    const history = useHistory();\r\n    let id = qs.parse(location.search).id || \"\";\r\n    const [detail, setDetail] = useState(null);\r\n    const [loading, setLoading] = useState(false); // loading\r\n    const [playList, setPlayList] = useState([]);\r\n    const [likePlayList, setLikePlayList] = useState([]);\r\n\r\n    const getList = async () => {\r\n        const res = await getUserPlayList({\r\n            uid: user.userId,\r\n        });\r\n        if (res.code === 200) {\r\n            let playList = res.playlist.filter(p => p.userId === user.userId);\r\n            let likePlayList = res.playlist.filter(p => p.userId !== user.userId);\r\n            history.replace('/myMusic?id=' + playList[0].id);\r\n            setPlayList(playList);\r\n            setLikePlayList(likePlayList);\r\n        }\r\n    }\r\n\r\n    //获取用户歌单\r\n    useEffect(() => {\r\n        getList();\r\n    }, [])\r\n\r\n    useEffect(() => {\r\n        (async () => {\r\n            setLoading(true);\r\n            const res = await getPlayListDetail({ id });\r\n            if (res.code === 200) {\r\n                setLoading(false);\r\n                setDetail(res.playlist);\r\n            }\r\n        })();\r\n    }, [id]);\r\n\r\n    const handle = () => {\r\n        getList();\r\n    }\r\n    return (\r\n        <div className={style['my-music']}>\r\n            <div className=\"left\">\r\n                <Left userId={user.userId} id={id} playList={playList} likePlayList={likePlayList} del={handle} create={handle} />\r\n            </div>\r\n            <div className=\"right\">\r\n                {detail ? <DetailLeft detail={detail} id={id} /> : null}\r\n            </div>\r\n            <Spin\r\n                spinning={loading}\r\n                tip=\"loading...\"\r\n                size=\"large\"\r\n                style={{\r\n                    position: \"fixed\",\r\n                    top: \"50%\",\r\n                    left: \"50%\",\r\n                    transform: \"translate(-50%, -50%)\",\r\n                    zIndex: \"9999\",\r\n                }}\r\n            ></Spin>\r\n        </div>\r\n    )\r\n}\r\n\r\nexport default connect(mapStateToProps)(MyMusic);\r\n"],"sourceRoot":""}