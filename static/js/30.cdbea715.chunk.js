(this["webpackJsonpmusic-player"]=this["webpackJsonpmusic-player"]||[]).push([[30],{1139:function(e,t,n){e.exports={"my-music":"myMusic_my-music__2nt73"}},1140:function(e,t,n){},1141:function(e,t,n){e.exports={"left-item":"item_left-item__3oR3v"}},1158:function(e,t,n){"use strict";n.r(t);var c=n(15),s=n.n(c),a=n(23),r=n(19),i=n(1),l=n(1139),u=n.n(l),o=n(1140),d=n.n(o),j=n(1141),b=n.n(j),f=n(26);function p(e){return m.apply(this,arguments)}function m(){return(m=Object(a.a)(s.a.mark((function e(t){var n,c;return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=t.id,e.next=3,f.a.post("/playlist/delete",{id:n});case 3:return c=e.sent,e.abrupt("return",c);case 5:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function O(){return(O=Object(a.a)(s.a.mark((function e(t){var n,c;return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=t.name,e.next=3,f.a.post("/playlist/create",{name:n});case 3:return c=e.sent,e.abrupt("return",c);case 5:case"end":return e.stop()}}),e)})))).apply(this,arguments)}var h=n(42),x=n(27),v=n(5);function y(e){var t=e.title,n=e.list,c=e.showBtn,l=e.id,u=e.showEdit,o=void 0===u||u,d=e.userId,j=Object(i.useState)(!0),f=Object(r.a)(j,2),m=f[0],y=f[1],w=Object(i.useState)(!1),N=Object(r.a)(w,2),k=N[0],I=N[1],g=Object(i.useState)(""),S=Object(r.a)(g,2),C=S[0],_=S[1],E=function(){var t=Object(a.a)(s.a.mark((function t(n){return s.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,p({id:n});case 2:200===t.sent.code&&(e.del&&e.del(),x.y.success({content:"\u5220\u9664\u6210\u529f"}));case 4:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}(),L=function(e){E(e)};return Object(v.jsxs)("div",{className:b.a["left-item"],children:[Object(v.jsxs)("div",{className:"item-header",children:[Object(v.jsxs)("span",{className:"wrap",onClick:function(){y(!m)},children:[Object(v.jsx)("i",{className:m?"icon icon-arrow-down":"icon icon-arrow-left"}),Object(v.jsxs)("span",{className:"text",children:[t,"\uff08",n.length,"\uff09"]})]}),c?Object(v.jsx)("span",{className:"add-btn",onClick:function(){I(!0)},children:Object(v.jsx)("i",{children:"\u65b0\u5efa"})}):null]}),m?Object(v.jsx)("ul",{className:"item-list",children:n.map((function(e,t){return Object(v.jsxs)("li",{className:e.id==l?"list-item active":"list-item",children:[Object(v.jsxs)(h.b,{to:"/myMusic?id="+e.id,className:"wrap",children:[Object(v.jsx)("img",{src:e.coverImgUrl,alt:""}),Object(v.jsxs)("div",{className:"info",children:[Object(v.jsx)("p",{className:"name ell",children:e.name}),Object(v.jsxs)("p",{className:"num ell",children:[e.trackCount,"\u9996 by ",e.creator.nickname]})]})]}),d==e.creator.userId&&0!==t||d!=e.creator.userId?Object(v.jsxs)("span",{className:"options",children:[o?Object(v.jsx)("i",{className:"icon-edit icon"}):null,Object(v.jsx)(x.l,{title:"\u786e\u5b9a\u5220\u9664\u6b4c\u5355\uff1f",onConfirm:L.bind(null,e.id),children:Object(v.jsx)("i",{className:"icon-del icon"})})]}):null]},e.id)}))}):null,Object(v.jsx)(x.j,{title:"\u65b0\u5efa\u6b4c\u5355",visible:k,onOk:function(){(function(e){return O.apply(this,arguments)})({name:C}).then((function(t){200===t.code&&(e.create&&e.create(),x.y.success({content:"\u521b\u5efa\u6210\u529f"}))})),I(!1),_("")},onCancel:function(){I(!1),_("")},mask:!1,children:Object(v.jsx)(x.h,{placeholder:"\u8bf7\u8f93\u5165\u65b0\u5efa\u6b4c\u5355\u540d\u79f0",value:C,onChange:function(e){_(e)}})})]})}var w=function(e){var t=e.id,n=e.playList,c=e.likePlayList,s=e.userId;return Object(v.jsxs)("div",{className:d.a.left,children:[Object(v.jsx)(y,{userId:s,list:n,title:"\u521b\u5efa\u7684\u6b4c\u5355",showBtn:!0,id:t,del:function(){e.del&&e.del()},create:function(){e.create&&e.create()}}),c.length?Object(v.jsx)(y,{list:c,title:"\u6536\u85cf\u7684\u6b4c\u5355",showBtn:!1,del:function(){e.del&&e.del()},showEdit:!1}):null]})},N=n(1041),k=n(1e3),I=n.n(k),g=n(104),S=n(50),C=n(105);t.default=Object(C.b)((function(e){return{user:e.user}}))((function(e){var t=e.user,n=Object(S.h)(),c=Object(S.g)(),l=I.a.parse(n.search).id||"",o=Object(i.useState)(null),d=Object(r.a)(o,2),j=d[0],b=d[1],f=Object(i.useState)(!1),p=Object(r.a)(f,2),m=p[0],O=p[1],h=Object(i.useState)([]),y=Object(r.a)(h,2),k=y[0],C=y[1],_=Object(i.useState)([]),E=Object(r.a)(_,2),L=E[0],B=E[1],M=function(){var e=Object(a.a)(s.a.mark((function e(){var n,a,r;return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Object(g.A)({uid:t.userId});case 2:200===(n=e.sent).code&&(a=n.playlist.filter((function(e){return e.userId===t.userId})),r=n.playlist.filter((function(e){return e.userId!==t.userId})),c.replace("/myMusic?id="+a[0].id),C(a),B(r));case 4:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}();Object(i.useEffect)((function(){M()}),[]),Object(i.useEffect)((function(){Object(a.a)(s.a.mark((function e(){var t;return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return O(!0),e.next=3,Object(g.q)({id:l});case 3:200===(t=e.sent).code&&(O(!1),b(t.playlist));case 5:case"end":return e.stop()}}),e)})))()}),[l]);var z=function(){M()};return Object(v.jsxs)("div",{className:u.a["my-music"],children:[Object(v.jsx)("div",{className:"left",children:Object(v.jsx)(w,{userId:t.userId,id:l,playList:k,likePlayList:L,del:z,create:z})}),Object(v.jsx)("div",{className:"right",children:j?Object(v.jsx)(N.a,{detail:j,id:l}):null}),Object(v.jsx)(x.t,{spinning:m,tip:"loading...",size:"large",style:{position:"fixed",top:"50%",left:"50%",transform:"translate(-50%, -50%)",zIndex:"9999"}})]})}))}}]);
//# sourceMappingURL=30.cdbea715.chunk.js.map