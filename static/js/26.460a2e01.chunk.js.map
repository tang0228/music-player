{"version":3,"sources":["services/user.js","pages/Friend/index.module.less","pages/Friend/right.module.less","pages/Friend/left.module.less","pages/Friend/Right.jsx","pages/Friend/Left.jsx","pages/Friend/index.jsx"],"names":["getUserEvent","a","uid","limit","lasttime","timestamp","Date","now","ins","get","params","res","share","id","type","msg","post","delEvent","evId","module","exports","Right","props","user","length","useState","userInfo","setUserInfo","useEffect","getUserDetail","userId","then","code","profile","className","style","to","src","avatarUrl","alt","nickname","signature","eventCount","follows","followeds","SHARE_MAP","Left","visible","setVisible","show","setShow","song","setSong","isChooseSong","setIsChooseSOng","setWord","songs","setSongs","setMsg","list","handleCancel","chooseSong","deleteEvent","Toast","success","delSuccess","title","onClick","window","open","map","l","content","onConfirm","bind","onCancel","utils","formatDate","showTime","json","img80x80","name","artists","mask","width","footer","shareSuccess","event","warning","disabled","prefix","onChange","val","search","keywords","result","s","k","select","isEven","i","placeholder","value","maxCount","onOk","React","memo","connect","state","setEvent","loading","setLoading","getEvent","e","JSON","parse","filter","spinning","tip","size","position","top","left","transform","zIndex"],"mappings":"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","file":"static/js/26.460a2e01.chunk.js","sourcesContent":["import ins from \"./request\";\r\n\r\n// 我的消息\r\nexport async function getUserEvent({ uid, limit, lasttime, timestamp = Date.now() }) {\r\n    const res = await ins.get('/event', {\r\n        params: {\r\n            uid, limit, lasttime, timestamp\r\n        }\r\n    });\r\n    return res;\r\n}\r\n\r\n// 分享动态\r\nexport async function share({ id, type = 'song', msg }) {\r\n    const res = await ins.post('/share/resource', {\r\n        id, type, msg\r\n    });\r\n    return res;\r\n}\r\n\r\n// 删除用户动态\r\nexport async function delEvent({ evId, timestamp = Date.now() }) {\r\n    const res = await ins.get('/event/del', {\r\n        params: {\r\n            evId,\r\n            timestamp\r\n        }\r\n    });\r\n    return res;\r\n}","// extracted by mini-css-extract-plugin\nmodule.exports = {\"friend-container\":\"index_friend-container__16ucv\"};","// extracted by mini-css-extract-plugin\nmodule.exports = {\"right-wrap\":\"right_right-wrap__Cmy1T\"};","// extracted by mini-css-extract-plugin\nmodule.exports = {\"left-wrap\":\"left_left-wrap__2nMeF\"};","import React, { useState, useEffect } from 'react'\r\nimport style from \"./right.module.less\"\r\nimport { Link } from \"react-router-dom\"\r\nimport { getUserDetail } from \"@/services/apis\"\r\n\r\n\r\nfunction Right(props) {\r\n    const { user, length } = props;\r\n    const [userInfo, setUserInfo] = useState(null);\r\n\r\n    useEffect(() => {\r\n        getUserDetail({\r\n            uid: user.userId\r\n        }).then(res => {\r\n            if (res.code === 200) {\r\n                setUserInfo(res.profile);\r\n            }\r\n        })\r\n    }, [length])\r\n\r\n    return (\r\n        <div className={style['right-wrap']}>\r\n            {userInfo ? <div className=\"user-wrap\">\r\n                <div className=\"user-top\">\r\n                    <div className=\"img-wrap\">\r\n                        <Link to={'/user/home?uid=' + userInfo.userId}><img src={userInfo.avatarUrl} alt=\"\" /></Link>\r\n                    </div>\r\n                    <div className=\"user-detail\">\r\n                        <Link to={'/user/home?uid=' + userInfo.userId} className=\"name\">{userInfo.nickname}</Link>\r\n                        <p className=\"desc\">{userInfo.signature}</p>\r\n                    </div>\r\n                </div>\r\n                <div className=\"user-nums\">\r\n                    <div className=\"box\">\r\n                        <span>{userInfo.eventCount}</span>\r\n                        <span>动态</span>\r\n                    </div>\r\n                    <div className=\"box\">\r\n                        <span>{userInfo.follows}</span>\r\n                        <span>关注</span>\r\n                    </div>\r\n                    <div className=\"box\">\r\n                        <span>{userInfo.followeds}</span>\r\n                        <span>粉丝</span>\r\n                    </div>\r\n                </div>\r\n            </div> : null}\r\n        </div>\r\n    )\r\n}\r\n\r\nexport default Right;\r\n","import React, { useState } from 'react'\r\nimport style from \"./left.module.less\"\r\nimport \"./modal.less\"\r\nimport { Link } from \"react-router-dom\"\r\nimport { Empty, Modal, TextArea, Toast, Input, Button, Popconfirm } from '@douyinfe/semi-ui'\r\nimport { IconSearch } from '@douyinfe/semi-icons'\r\nimport { search } from \"@/services/search\"\r\nimport utils from \"@/utils\"\r\nimport { share, delEvent } from \"@/services/user\"\r\n\r\nconst SHARE_MAP = {\r\n    '18': \"分享单曲\",\r\n    '19': \"分享专辑\",\r\n    '17': \"分享电台节目\",\r\n    '28': \"分享电台节目\",\r\n    '22': \"转发\",\r\n    '39': \"发布视频\",\r\n    '24': \"分享专栏文章\",\r\n    '35': \"分享歌单\",\r\n    '13': \"分享歌单\",\r\n    '41': \"分享视频\",\r\n    '21': \"分享视频\",\r\n}\r\n\r\nfunction Left(props) {\r\n    const [visible, setVisible] = useState(false);\r\n    const [show, setShow] = useState(false);\r\n\r\n    const [song, setSong] = useState(null);// 选中的单曲\r\n    const [isChooseSong, setIsChooseSOng] = useState(false); // 是否正在选择歌曲\r\n    const [word, setWord] = useState(\"\"); // 搜索框的关键词\r\n    const [songs, setSongs] = useState([]); // 伸缩的歌曲列表\r\n    const [msg, setMsg] = useState(\"\");\r\n\r\n    const { list, user } = props;\r\n\r\n    const shareNew = () => {\r\n        share({ id: song.id, msg }).then(res => {\r\n            if (res.code === 200) {\r\n                props.shareSuccess && props.shareSuccess(res.event);\r\n            }\r\n        })\r\n    }\r\n\r\n    const handleAreaChange = val => {\r\n        setMsg(val);\r\n    }\r\n\r\n    const handleOk = () => {\r\n        if (!song) {\r\n            Toast.warning({\r\n                content: \"请选择单曲哦\"\r\n            });\r\n            return;\r\n        }\r\n        shareNew();\r\n        setVisible(false);\r\n        setMsg(\"\");\r\n        setSong(null);\r\n    }\r\n    const handleCancel = () => {\r\n        if (msg || song) {\r\n            setShow(true);\r\n            return;\r\n        }\r\n        setVisible(false)\r\n    }\r\n\r\n    // 返回\r\n    const back = () => {\r\n        setIsChooseSOng(false);\r\n        setWord(\"\");\r\n        setSongs([]);\r\n    }\r\n\r\n    const chooseSong = () => {\r\n        setIsChooseSOng(true);\r\n    }\r\n\r\n    // 搜索歌曲\r\n    const handleInpChange = val => {\r\n        // setWord(val);\r\n        if (!val) {\r\n            setSongs([]);\r\n            return;\r\n        }\r\n        search({ keywords: val }).then(res => {\r\n            if (res.code === 200) {\r\n                setSongs(res.result.songs);\r\n            }\r\n        })\r\n    }\r\n\r\n    // 确认选中歌曲\r\n    const select = s => {\r\n        setSong(s);\r\n        setIsChooseSOng(false);\r\n    }\r\n\r\n    // 删除动态\r\n    const deleteEvent = (id) => {\r\n        delEvent({ evId: id }).then(res => {\r\n            if (res.code === 200) {\r\n                Toast.success(\"删除成功\");\r\n                props.delSuccess && props.delSuccess(id);\r\n            }\r\n        })\r\n    }\r\n\r\n\r\n    return (\r\n        <div className={style['left-wrap']}>\r\n            <div className=\"list-header\">\r\n                <h3 className=\"title\">动态</h3>\r\n                <span className=\"btn btn-video\" title='发动态' onClick={() => {\r\n                    setVisible(true);\r\n                }}></span>\r\n                <span className=\"btn btn-msg\" title=\"发布视频\" onClick={() => {\r\n                    window.open('https://music.163.com/st/ncreator/upload')\r\n                }}></span>\r\n            </div>\r\n            {list.length ? <ul className=\"list-wrap\">\r\n                {list.map(l => <li key={l.id} className=\"list-item\">\r\n                    {user.userId === l.user.userId ? <Popconfirm\r\n                        title=\"提示\"\r\n                        content=\"你确定要删除该动态吗？\"\r\n                        onConfirm={deleteEvent.bind(null, l.id)}\r\n                        onCancel={() => { }}\r\n                    >\r\n                        <span className=\"icon-arrow\">删除</span>\r\n                    </Popconfirm> : null}\r\n                    <Link to={'/user/home?uid=' + l.user.userId}>\r\n                        <img className='avatar' src={l.user.avatarUrl} alt=\"\" />\r\n                    </Link>\r\n                    <div className=\"main-content\">\r\n                        <div className=\"user-name\">\r\n                            <Link className='nickname' to={'/user/home?uid=' + l.user.userId}>{l.user.nickname}</Link>\r\n                            <span className=\"text\">{SHARE_MAP[l.type]}</span>\r\n                        </div>\r\n                        <div className=\"time\">{utils.formatDate(l.showTime)}</div>\r\n                        <div className=\"share-text\">{l.json.msg}</div>\r\n                        {l.json.song ? <div className=\"flag\">\r\n                            <div className=\"img-wrap\">\r\n                                <img src={l.json.song.img80x80 || \"http://s4.music.126.net/style/web2/img/default/default_avatar.jpg?param=50y50\"} alt=\"\" />\r\n                                <i className=\"icon-play\"></i>\r\n                            </div>\r\n                            <div className=\"song-info\">\r\n                                <p className='song-name'><Link to={'/find/song?id=' + l.json.song.id}>{l.json.song.name}</Link></p>\r\n                                <p className=\"artist-name\"><Link to={'/find/artist?id=' + l.json.song.artists[0].id}>{l.json.song.artists[0].name}</Link></p>\r\n                            </div>\r\n                        </div> : null}\r\n                    </div>\r\n                </li>)}\r\n            </ul> : <Empty\r\n                title=\"暂时还没有动态\"\r\n            />}\r\n\r\n            <Modal\r\n                title={isChooseSong ? '添加音乐' : '分享'}\r\n                visible={visible}\r\n                mask={false}\r\n                onCancel={handleCancel}\r\n                className='share-modal'\r\n                width={528}\r\n                footer={\r\n                    isChooseSong ? <Button type=\"primary\" onClick={back}>\r\n                        返回\r\n                    </Button> :\r\n                        <>\r\n                            <Button type=\"primary\" onClick={handleOk} disabled={!msg || !song}>\r\n                                分享\r\n                            </Button>\r\n                            <Button type=\"tertiary\" onClick={handleCancel}>\r\n                                取消\r\n                            </Button>\r\n                        </>\r\n                }\r\n            >\r\n                {!isChooseSong ? <>\r\n                    <TextArea placeholder='一起聊聊吧~' value={msg} maxCount={140} onChange={handleAreaChange} />\r\n                    {!song ? <div className=\"song-box\" onClick={chooseSong}>\r\n                        <i className=\"icon-img\"></i>\r\n                        <span className=\"text\">给动态配上音乐</span>\r\n                        <i className=\"icon-add\"></i>\r\n                    </div> : <div className=\"song-box\" onClick={chooseSong}>\r\n                        <span className=\"text\">单曲：{song.name} - {song.artists.map((a, i) => <span key={a.id} >\r\n                            {i !== 0 ? '/' + a.name : a.name}\r\n                        </span>)} </span>\r\n                        <i className=\"icon-arrow\"></i>\r\n                    </div>}\r\n                </> : <>\r\n                    <Input prefix={<IconSearch />} onChange={handleInpChange} ></Input>\r\n                    <ul className='list-wrap'>\r\n                        {songs.length ? songs.map((s, k) => <li key={s.id} onClick={() => {\r\n                            select(s)\r\n                        }\r\n                        } className={utils.isEven(k) ? 'list-item even' : 'list-item'}>\r\n                            <i className=\"icon-play\"></i>\r\n                            <span className=\"song-name ell\">{s.name}</span>\r\n                            <span className=\"artist-name ell\">\r\n                                {s.artists.map((a, i) => <span key={a.id} >\r\n                                    {i !== 0 ? '/' + a.name : a.name}\r\n                                </span>)}\r\n                            </span>\r\n                        </li>) : null}\r\n                    </ul>\r\n                </>}\r\n            </Modal >\r\n            <Modal\r\n                title=\"提示\"\r\n                visible={show}\r\n                onOk={() => {\r\n                    setShow(false);\r\n                    setVisible(false);\r\n                    setMsg(\"\");\r\n                    setSong(null);\r\n                }}\r\n                onCancel={() => {\r\n                    setShow(false);\r\n                }}\r\n                mask={false}\r\n            >\r\n                是否退出本次编辑？\r\n            </Modal>\r\n        </div >\r\n    )\r\n}\r\n\r\nexport default React.memo(Left);","import React, { useEffect, useState } from 'react'\r\nimport {getUserEvent} from \"@/services/user\"\r\nimport style from \"./index.module.less\"\r\nimport Right from \"./Right\"\r\nimport Left from \"./Left\"\r\nimport { Spin } from '@douyinfe/semi-ui'\r\nimport { connect } from 'react-redux'\r\n// import utils from \"@/utils\"\r\n\r\nconst mapStateToProps = (state) => ({\r\n    user: state.user\r\n});\r\n\r\nfunction Friend(props) {\r\n    const { user } = props\r\n    const [event, setEvent] = useState([]); // 动态\r\n    const [loading, setLoading] = useState(false);\r\n\r\n    useEffect(() => {\r\n        getEvent();\r\n    }, [])\r\n\r\n    // useEffect(() => {\r\n    //     window.addEventListener('scroll', utils.throttle(handleScroll, 1000))\r\n    //     return () => {\r\n    //         window.removeEventListener('scroll', handleScroll);\r\n    //     }\r\n    // }, [])\r\n\r\n    // const handleScroll = () => {\r\n    //     if(loading) {\r\n    //         return;\r\n    //     }\r\n    //     const dom = document.documentElement;\r\n    //     const dx = Math.abs(dom.scrollTop + dom.clientHeight - dom.offsetHeight);\r\n    //     if(dx < 100 && more) {\r\n    //         getEvent();\r\n    //     }\r\n    // }\r\n\r\n    const getEvent = async () => {\r\n        setLoading(true);\r\n        const res = await getUserEvent({\r\n            uid: user.userId,\r\n            limit: 20,\r\n        });\r\n        if (res.code === 200) {\r\n            setLoading(false);\r\n            const list = res.event.map(e => ({\r\n                ...e,\r\n                json: JSON.parse(e.json)\r\n            }));\r\n            setEvent(list);\r\n        }\r\n    }\r\n\r\n    const shareSuccess = (e) => {\r\n        setEvent([{...e, json: JSON.parse(e.json)}, ...event]);\r\n        // getEvent();\r\n    }\r\n\r\n    const delSuccess = id => {\r\n        const res = event.filter(e => e.id !== id);\r\n        setEvent(res);\r\n    }\r\n    return (\r\n        <div className={style[\"friend-container\"]}>\r\n            <div className=\"left\">\r\n                <Left list={event} shareSuccess={shareSuccess} delSuccess={delSuccess} user={user} />\r\n            </div>\r\n            <div className=\"right\">\r\n                <Right length={event.length} user={user} />\r\n            </div>\r\n            <Spin\r\n                spinning={loading}\r\n                tip=\"loading...\"\r\n                size=\"large\"\r\n                style={{\r\n                    position: \"fixed\",\r\n                    top: \"50%\",\r\n                    left: \"50%\",\r\n                    transform: \"translate(-50%, -50%)\",\r\n                    zIndex: \"9999\",\r\n                }}\r\n            ></Spin>\r\n        </div>\r\n    )\r\n}\r\n\r\nexport default connect(mapStateToProps)(Friend);\r\n"],"sourceRoot":""}