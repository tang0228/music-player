{"version":3,"sources":["assets/loading.svg","pages/Find/modules/Item.jsx","pages/Find/modules/CatSelect.jsx","pages/Find/modules/Category.jsx","pages/Find/modules/PlayList.jsx"],"names":["Item","props","className","to","id","height","debounce","placeholder","width","src","loadingUrl","coverImgUrl","alt","parseInt","playCount","description","creator","userId","nickname","iconArr","CatSelect","categories","history","useHistory","location","useLocation","cat","qs","parse","search","useState","showSelect","setShowSelect","openSelect","useCallback","handleCatClick","e","name","target","outerText","catChange","push","window","encodeURIComponent","items","Array","isArray","map","c","i","subCat","s","onClick","type","transferCat","sub","newCat","key","category","forEach","Category","setCategories","setCat","useEffect","a","getPlayListCat","res","PlayList","limit","setLimit","page","setPage","list","setList","total","setTotal","loading","setLoading","getPlaylist","offset","code","playlists","utils","unique","handlePageChange","val","handleLimitChange","lis","l","currentPage","onPageChange","showSizeChanger","pageSize","pageSizeOpts","onPageSizeChange","spinning","tip","size","style","position","top","left","transform","zIndex"],"mappings":"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","file":"static/js/25.0054220a.chunk.js","sourcesContent":["export default __webpack_public_path__ + \"static/media/loading.4c0ea1e7.svg\";","import React from \"react\";\r\nimport LazyLoad from \"react-lazyload\";\r\nimport { IconCustomerSupport, IconPlayCircle } from \"@douyinfe/semi-icons\";\r\nimport \"./item.less\";\r\nimport { Link } from \"react-router-dom\";\r\nimport loadingUrl from \"@/assets/loading.svg\";\r\n\r\nexport default function Item(props) {\r\n\treturn (\r\n\t\t<li className=\"item-wrapper\">\r\n\t\t\t<div\r\n\t\t\t\tclassName=\"item-content\"\r\n\t\t\t><Link to={`/find/playlist/detail?id=${props.id}`}>\r\n\t\t\t\t\t<LazyLoad height={140} debounce={500} placeholder={<img width=\"100%\" height=\"100%\" src={loadingUrl} />}>\r\n\t\t\t\t\t\t<img src={props.coverImgUrl} alt=\"\" />\r\n\t\t\t\t\t</LazyLoad>\r\n\t\t\t\t\t<span className=\"mask\"></span>\r\n\t\t\t\t\t<div className=\"bottom\">\r\n\t\t\t\t\t\t<IconCustomerSupport />\r\n\t\t\t\t\t\t<span className=\"play-nums\">\r\n\t\t\t\t\t\t\t{parseInt(props.playCount / 10000)}万\r\n\t\t\t\t\t\t</span>\r\n\t\t\t\t\t\t<IconPlayCircle />\r\n\t\t\t\t\t</div>\r\n\t\t\t\t</Link>\r\n\t\t\t</div>\r\n\t\t\t<p className=\"desc\">\r\n\t\t\t\t<Link to={`/find/playlist/detail?id=${props.id}`}>{props.description}</Link>\r\n\t\t\t</p>\r\n\t\t\t<p className=\"user\">\r\n\t\t\t\t<span className=\"text\">by</span>\r\n\t\t\t\t<Link className=\"name\" to={`/user/home?uid=${props.creator.userId}`}>{props.creator.nickname}</Link>\r\n\t\t\t</p>\r\n\t\t</li>\r\n\t);\r\n}\r\n","import React, { useState, useCallback } from \"react\";\r\nimport { useHistory, useLocation } from \"react-router-dom\";\r\nimport qs from \"query-string\";\r\nimport {\r\n  IconChevronDown,\r\n  IconMusic,\r\n  IconGlobeStroke,\r\n  IconCheckList,\r\n  IconHourglass,\r\n  IconLikeHeart,\r\n} from \"@douyinfe/semi-icons\";\r\nimport { Button } from \"@douyinfe/semi-ui\";\r\nimport \"./catSelect.less\";\r\n\r\nconst iconArr = [\r\n  <IconGlobeStroke />,\r\n  <IconCheckList />,\r\n  <IconHourglass />,\r\n  <IconLikeHeart />,\r\n  <IconMusic />,\r\n];\r\n\r\nexport default function CatSelect(props) {\r\n  const { categories } = props;\r\n  const history = useHistory();\r\n  const location = useLocation();\r\n  const cat = qs.parse(location.search).cat;\r\n  const [showSelect, setShowSelect] = useState(false); // 是否打开下拉框\r\n  const openSelect = useCallback(() => {\r\n    setShowSelect(!showSelect);\r\n  }, [showSelect]);\r\n\r\n  const handleCatClick = useCallback(\r\n      (e) => {\r\n          let name = e.target.outerText;\r\n          if(name === \"全部风格\") {\r\n            props.catChange && props.catChange(\"\");\r\n            history.push(`/find/playlist`)\r\n          } else {\r\n            props.catChange && props.catChange(name);\r\n            history.push(`/find/playlist?cat=${window.encodeURIComponent(name)}`)\r\n          }\r\n      },\r\n      [],\r\n  )\r\n\r\n  const items =\r\n    Array.isArray(categories) &&\r\n    categories.map((c, i) => (\r\n      <dl className=\"select-row\" key={c.name}>\r\n        <dt className=\"title\">\r\n          {iconArr[i]}\r\n          <span className=\"text\">{c.name}</span>\r\n        </dt>\r\n        <dd className={\"item\"}>\r\n          {c.subCat.map((s) => (\r\n            <span key={s.name}>\r\n              <span className={cat === s.name ? 'cat selected' : 'cat'} onClick={handleCatClick}>{s.name}</span>\r\n              <span className=\"line\">|</span>\r\n            </span>\r\n          ))}\r\n        </dd>\r\n      </dl>\r\n    ));\r\n  return (\r\n    <div className=\"select-wrapper\">\r\n      <div className=\"select-btn\" onClick={openSelect}>\r\n        <span className=\"select-title\">选择分类</span>\r\n        <IconChevronDown />\r\n      </div>\r\n      {showSelect ? (\r\n        <div className=\"select-content\">\r\n          <div className=\"all\">\r\n            <Button type=\"primary\" onClick={handleCatClick}>全部风格</Button>\r\n          </div>\r\n          {items}\r\n        </div>\r\n      ) : null}\r\n    </div>\r\n  );\r\n}\r\n","import React, { useEffect, useState, useCallback} from 'react';\r\nimport \"./category.less\";\r\nimport { getPlayListCat } from \"../../../services/apis\";\r\nimport CatSelect from './CatSelect';\r\nimport qs from \"query-string\";\r\nimport { useLocation } from \"react-router-dom\";\r\n\r\nfunction transferCat(cat, sub) {\r\n    let newCat = [];\r\n    for (const key in cat) {\r\n        newCat.push({\r\n            name: cat[key],\r\n            category: key,\r\n            subCat: [],\r\n        })\r\n    }\r\n    Array.isArray(sub) && sub.forEach((c, i) => {\r\n        newCat[c.category].subCat.push(c);\r\n    });\r\n    return newCat;\r\n}\r\n\r\nexport default function Category() {\r\n    const location = useLocation();\r\n    const [categories, setCategories] = useState();\r\n    const [cat, setCat] = useState(qs.parse(location.search).cat);\r\n    useEffect(() => {\r\n        (async () => {\r\n            const res = await getPlayListCat();\r\n            const newCat = transferCat(res.categories, res.sub);\r\n            setCategories(newCat);\r\n        })();\r\n        return () => {\r\n        }\r\n    }, []);\r\n\r\n    const catChange = useCallback(\r\n        (name) => {\r\n            setCat(name);\r\n        },\r\n        [],\r\n    )\r\n    return (\r\n        <div className=\"cat-container\">\r\n            <div className=\"cat-select\">\r\n                <span className=\"cat-title\">{cat ? cat : '全部'}</span>\r\n                <CatSelect categories={categories} catChange={catChange} />\r\n            </div>\r\n        </div>\r\n    )\r\n}\r\n","import React, { useEffect, useState, useCallback } from \"react\";\r\nimport { getPlaylist } from \"../../../services/apis\";\r\nimport { useLocation } from \"react-router-dom\";\r\nimport Item from \"./Item\";\r\nimport Category from \"./Category\";\r\nimport { Pagination, Spin } from \"@douyinfe/semi-ui\";\r\nimport \"./playlist.less\";\r\nimport utils from \"../../../utils\";\r\nimport qs from \"query-string\";\r\n\r\nexport default function PlayList() {\r\n\tconst [limit, setLimit] = useState(35); // 页容量\r\n\tconst [page, setPage] = useState(1); // 页码\r\n\tconst [list, setList] = useState([]); // 歌单列表\r\n\tconst [total, setTotal] = useState(0); // 歌单总数\r\n\tconst [loading, setLoading] = useState(false); // 加载中\r\n\tconst location = useLocation();\r\n\tconst cat = qs.parse(location.search).cat || \"\";\r\n\t// 获取歌单\r\n\tuseEffect(() => {\r\n\t\t(async () => {\r\n\t\t\tsetLoading(true);\r\n\t\t\tconst res = await getPlaylist({\r\n\t\t\t\toffset: (page - 1) * limit,\r\n\t\t\t\tlimit,\r\n\t\t\t\tcat,\r\n\t\t\t});\r\n\t\t\tif (res.code === 200) {\r\n\t\t\t\t// 去重\r\n\t\t\t\tconst playlists = utils.unique(res.playlists);\r\n\t\t\t\tsetList(playlists);\r\n\t\t\t\tsetTotal(res.total);\r\n\t\t\t\tsetLoading(false);\r\n\t\t\t}\r\n\t\t})();\r\n\t\treturn () => { };\r\n\t}, [page, limit, cat]);\r\n\t// 页码变化\r\n\tconst handlePageChange = useCallback((val) => {\r\n\t\tsetPage(val);\r\n\t}, []);\r\n\t// 页容量变化\r\n\tconst handleLimitChange = useCallback((val) => {\r\n\t\tsetLimit(val);\r\n\t}, []);\r\n\t// 每一个歌单元素\r\n\tconst lis = list.map((l) => <Item key={l.id} {...l}></Item>);\r\n\treturn (\r\n\t\t<div className=\"playlist-container\">\r\n\t\t\t<Category />\r\n\t\t\t<ul className=\"ul-wrapper\">{lis}</ul>\r\n\t\t\t{!loading ? (\r\n\t\t\t\t<div className=\"pagination-wrapper\">\r\n\t\t\t\t\t<Pagination\r\n\t\t\t\t\t\ttotal={total}\r\n\t\t\t\t\t\tcurrentPage={page}\r\n\t\t\t\t\t\tonPageChange={handlePageChange}\r\n\t\t\t\t\t\tshowSizeChanger\r\n\t\t\t\t\t\tpageSize={limit}\r\n\t\t\t\t\t\tpageSizeOpts={[15, 35, 70]}\r\n\t\t\t\t\t\tonPageSizeChange={handleLimitChange}\r\n\t\t\t\t\t></Pagination>\r\n\t\t\t\t</div>\r\n\t\t\t) : null}\r\n\t\t\t<Spin\r\n\t\t\t\tspinning={loading}\r\n\t\t\t\ttip=\"loading...\"\r\n\t\t\t\tsize=\"large\"\r\n\t\t\t\tstyle={{\r\n\t\t\t\t\tposition: \"fixed\",\r\n\t\t\t\t\ttop: \"50%\",\r\n\t\t\t\t\tleft: \"50%\",\r\n\t\t\t\t\ttransform: \"translate(-50%, -50%)\",\r\n\t\t\t\t\tzIndex: \"9999\",\r\n\t\t\t\t}}\r\n\t\t\t></Spin>\r\n\t\t</div>\r\n\t);\r\n}\r\n"],"sourceRoot":""}