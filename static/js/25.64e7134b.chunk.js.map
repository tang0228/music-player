{"version":3,"sources":["pages/Find/modules/item.module.less","pages/Find/modules/Item.jsx","pages/Find/modules/CatSelect.jsx","pages/Find/modules/Category.jsx","pages/Find/modules/PlayList.jsx","assets/loading.svg"],"names":["module","exports","connect","state","curSongId","dispatch","setCurSongId","setCurSongIdAction","addSongs","addSongListAction","props","className","style","height","debounce","placeholder","width","src","loadingUrl","coverImgUrl","alt","to","id","title","onClick","getPlayListDetail","then","res","code","Toast","success","content","duration","list","playlist","tracks","map","t","url","song","bind","parseInt","playCount","description","creator","userId","nickname","iconArr","CatSelect","categories","history","useHistory","location","useLocation","cat","qs","parse","search","useState","showSelect","setShowSelect","useEffect","window","addEventListener","handleClick","removeEventListener","e","handleCatClick","name","target","outerText","catChange","push","encodeURIComponent","items","Array","isArray","c","i","subCat","s","stopPropagation","type","transferCat","sub","newCat","key","category","forEach","Category","setCategories","setCat","a","getPlayListCat","PlayList","limit","setLimit","page","setPage","setList","total","setTotal","loading","setLoading","getPlaylist","offset","playlists","utils","unique","lis","l","currentPage","onPageChange","val","showSizeChanger","pageSize","pageSizeOpts","onPageSizeChange","spinning","tip","size","position","top","left","transform","zIndex"],"mappings":"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","file":"static/js/25.64e7134b.chunk.js","sourcesContent":["// extracted by mini-css-extract-plugin\nmodule.exports = {\"item-wrapper\":\"item_item-wrapper__2SeY6\"};","import React from \"react\";\r\nimport LazyLoad from \"react-lazyload\";\r\nimport style from \"./item.module.less\";\r\nimport { Link } from \"react-router-dom\";\r\nimport loadingUrl from \"@/assets/loading.svg\";\r\nimport { getPlayListDetail } from \"@/services/apis\";\r\nimport { addSongListAction } from \"@/store/actions/song\";\r\nimport { setCurSongIdAction } from \"@/store/actions/curSongId\";\r\nimport { connect } from \"react-redux\";\r\nimport { Toast } from \"@douyinfe/semi-ui\";\r\n\r\nconst mapStateToProps = (state) => {\r\n\treturn {\r\n\t\tcurSongId: state.curSongId,\r\n\t};\r\n};\r\n\r\nconst mapDispatchToProps = (dispatch) => {\r\n\treturn {\r\n\t\tsetCurSongId: (...args) => dispatch(setCurSongIdAction(...args)),\r\n\t\taddSongs: (...args) => dispatch(addSongListAction(...args))\r\n\t};\r\n};\r\n\r\nfunction Item(props) {\r\n\tconst { setCurSongId, addSongs } = props;\r\n\t// 添加歌单到播放列表\r\n\tconst addSongList = () => {\r\n\t\tgetPlayListDetail({ id: props.id }).then(res => {\r\n\t\t\tif (res.code === 200) {\r\n\t\t\t\tToast.success({\r\n\t\t\t\t\tcontent: \"成功添加歌单到播放列表\",\r\n\t\t\t\t\tduration: 2\r\n\t\t\t\t});\r\n\t\t\t\tconst list = res.playlist.tracks.map(t => ({\r\n\t\t\t\t\tid: t.id,\r\n\t\t\t\t\turl: 'https://music.163.com/song/media/outer/url?id=' + t.id + '.mp3',\r\n\t\t\t\t\tsong: t\r\n\t\t\t\t}));\r\n\t\t\t\taddSongs(list);\r\n\t\t\t\tsetCurSongId(list[0].id);\r\n\t\t\t}\r\n\t\t})\r\n\t}\r\n\treturn (\r\n\t\t<li className={style[\"item-wrapper\"]}>\r\n\t\t\t<div\r\n\t\t\t\tclassName=\"item-content\"\r\n\t\t\t>\r\n\t\t\t\t<LazyLoad height={140} debounce={500} placeholder={<img width=\"100%\" height=\"100%\" src={loadingUrl} />}>\r\n\t\t\t\t\t<img src={props.coverImgUrl} alt=\"\" />\r\n\t\t\t\t</LazyLoad>\r\n\t\t\t\t<Link to={`/find/playlist/detail?id=${props.id}`}>\r\n\t\t\t\t\t<span className=\"mask\"></span>\r\n\t\t\t\t</Link>\r\n\t\t\t\t<div className=\"bottom\">\r\n\t\t\t\t\t<i className=\"icon-heard\"></i>\r\n\t\t\t\t\t<i className=\"icon-play\" title=\"播放\" onClick={addSongList.bind(null, props.id)}></i>\r\n\t\t\t\t\t<span className=\"play-nums\">\r\n\t\t\t\t\t\t{parseInt(props.playCount / 10000)}万\r\n\t\t\t\t\t</span>\r\n\t\t\t\t</div>\r\n\r\n\t\t\t</div>\r\n\t\t\t<p className=\"desc\">\r\n\t\t\t\t<Link to={`/find/playlist/detail?id=${props.id}`}>{props.description}</Link>\r\n\t\t\t</p>\r\n\t\t\t<p className=\"user\">\r\n\t\t\t\t<span className=\"text\">by</span>\r\n\t\t\t\t<Link className=\"name\" to={`/user/home?uid=${props.creator.userId}`}>{props.creator.nickname}</Link>\r\n\t\t\t</p>\r\n\t\t</li>\r\n\t);\r\n}\r\n\r\nexport default connect(mapStateToProps, mapDispatchToProps)(Item);\r\n","import React, { useState, useEffect } from \"react\";\r\nimport { useHistory, useLocation } from \"react-router-dom\";\r\nimport qs from \"query-string\";\r\nimport {\r\n\tIconChevronDown,\r\n\tIconMusic,\r\n\tIconGlobeStroke,\r\n\tIconCheckList,\r\n\tIconHourglass,\r\n\tIconLikeHeart,\r\n} from \"@douyinfe/semi-icons\";\r\nimport { Button } from \"@douyinfe/semi-ui\";\r\nimport \"./catSelect.less\";\r\n\r\nconst iconArr = [\r\n\t<IconGlobeStroke />,\r\n\t<IconCheckList />,\r\n\t<IconHourglass />,\r\n\t<IconLikeHeart />,\r\n\t<IconMusic />,\r\n];\r\n\r\nexport default function CatSelect(props) {\r\n\tconst { categories } = props;\r\n\tconst history = useHistory();\r\n\tconst location = useLocation();\r\n\tconst cat = qs.parse(location.search).cat;\r\n\tconst [showSelect, setShowSelect] = useState(false); // 是否打开下拉框\r\n\r\n\tuseEffect(() => {\r\n\t\twindow.addEventListener('click', handleClick);\r\n\t\treturn () => {\r\n\t\t\twindow.removeEventListener('click', handleClick);\r\n\t\t}\r\n\t}, [])\r\n\r\n\tconst handleClick = e => {\r\n\t\tsetShowSelect(false);\r\n\t}\r\n\r\n\r\n\tconst openSelect = () => {\r\n\t\tsetShowSelect(!showSelect);\r\n\t};\r\n\r\n\tconst handleCatClick = (e) => {\r\n\t\tsetShowSelect(false);\r\n\t\tlet name = e.target.outerText;\r\n\t\tif (name === \"全部风格\") {\r\n\t\t\tprops.catChange && props.catChange(\"\");\r\n\t\t\thistory.push(`/find/playlist`)\r\n\t\t} else {\r\n\t\t\tprops.catChange && props.catChange(name);\r\n\t\t\thistory.push(`/find/playlist?cat=${window.encodeURIComponent(name)}`)\r\n\t\t}\r\n\t};\r\n\r\n\tconst items =\r\n\t\tArray.isArray(categories) &&\r\n\t\tcategories.map((c, i) => (\r\n\t\t\t<dl className=\"select-row\" key={c.name}>\r\n\t\t\t\t<dt className=\"title\">\r\n\t\t\t\t\t{iconArr[i]}\r\n\t\t\t\t\t<span className=\"text\">{c.name}</span>\r\n\t\t\t\t</dt>\r\n\t\t\t\t<dd className={\"item\"}>\r\n\t\t\t\t\t{c.subCat.map((s) => (\r\n\t\t\t\t\t\t<span key={s.name}>\r\n\t\t\t\t\t\t\t<span className={cat === s.name ? 'cat selected' : 'cat'} onClick={handleCatClick}>{s.name}</span>\r\n\t\t\t\t\t\t\t<span className=\"line\">|</span>\r\n\t\t\t\t\t\t</span>\r\n\t\t\t\t\t))}\r\n\t\t\t\t</dd>\r\n\t\t\t</dl>\r\n\t\t));\r\n\treturn (\r\n\t\t<div className=\"select-wrapper\" onClick={e => {\r\n\t\t\te.stopPropagation();\r\n\t\t}}>\r\n\t\t\t<div className=\"select-btn\" onClick={openSelect}>\r\n\t\t\t\t<span className=\"select-title\">选择分类</span>\r\n\t\t\t\t<IconChevronDown />\r\n\t\t\t</div>\r\n\t\t\t{showSelect ? (\r\n\t\t\t\t<div className=\"select-content\">\r\n\t\t\t\t\t<div className=\"all\">\r\n\t\t\t\t\t\t<Button type=\"primary\" onClick={handleCatClick}>全部风格</Button>\r\n\t\t\t\t\t</div>\r\n\t\t\t\t\t{items}\r\n\t\t\t\t</div>\r\n\t\t\t) : null}\r\n\t\t</div>\r\n\t);\r\n}\r\n","import React, { useEffect, useState } from 'react';\r\nimport \"./category.less\";\r\nimport { getPlayListCat } from \"../../../services/apis\";\r\nimport CatSelect from './CatSelect';\r\nimport qs from \"query-string\";\r\nimport { useLocation } from \"react-router-dom\";\r\n\r\nfunction transferCat(cat, sub) {\r\n    let newCat = [];\r\n    for (const key in cat) {\r\n        newCat.push({\r\n            name: cat[key],\r\n            category: key,\r\n            subCat: [],\r\n        })\r\n    }\r\n    Array.isArray(sub) && sub.forEach((c, i) => {\r\n        newCat[c.category].subCat.push(c);\r\n    });\r\n    return newCat;\r\n}\r\n\r\nexport default function Category() {\r\n    const location = useLocation();\r\n    const [categories, setCategories] = useState();\r\n    const [cat, setCat] = useState(qs.parse(location.search).cat);\r\n    useEffect(() => {\r\n        (async () => {\r\n            const res = await getPlayListCat();\r\n            const newCat = transferCat(res.categories, res.sub);\r\n            setCategories(newCat);\r\n        })();\r\n        return () => {\r\n        }\r\n    }, []);\r\n\r\n    const catChange = (name) => {\r\n        setCat(name);\r\n    };\r\n    return (\r\n        <div className=\"cat-container\">\r\n            <div className=\"cat-select\">\r\n                <span className=\"cat-title\">{cat ? cat : '全部'}</span>\r\n                <CatSelect categories={categories} catChange={catChange} />\r\n            </div>\r\n        </div>\r\n    )\r\n}\r\n","import React, { useEffect, useState } from \"react\";\r\nimport { getPlaylist } from \"../../../services/apis\";\r\nimport { useLocation } from \"react-router-dom\";\r\nimport Item from \"./Item\";\r\nimport Category from \"./Category\";\r\nimport { Pagination, Spin } from \"@douyinfe/semi-ui\";\r\nimport \"./playlist.less\";\r\nimport utils from \"../../../utils\";\r\nimport qs from \"query-string\";\r\n\r\nexport default function PlayList() {\r\n\tconst [limit, setLimit] = useState(35); // 页容量\r\n\tconst [page, setPage] = useState(1); // 页码\r\n\tconst [list, setList] = useState([]); // 歌单列表\r\n\tconst [total, setTotal] = useState(0); // 歌单总数\r\n\tconst [loading, setLoading] = useState(false); // 加载中\r\n\tconst location = useLocation();\r\n\tconst cat = qs.parse(location.search).cat || \"\";\r\n\t// 获取歌单\r\n\tuseEffect(() => {\r\n\t\t(async () => {\r\n\t\t\tsetLoading(true);\r\n\t\t\tconst res = await getPlaylist({\r\n\t\t\t\toffset: (page - 1) * limit,\r\n\t\t\t\tlimit,\r\n\t\t\t\tcat,\r\n\t\t\t});\r\n\t\t\tif (res.code === 200) {\r\n\t\t\t\t// 去重\r\n\t\t\t\tconst playlists = utils.unique(res.playlists);\r\n\t\t\t\tsetList(playlists);\r\n\t\t\t\tsetTotal(res.total);\r\n\t\t\t\tsetLoading(false);\r\n\t\t\t}\r\n\t\t})();\r\n\t\treturn () => { };\r\n\t}, [page, limit, cat]);\r\n\t// 页码变化\r\n\tconst handlePageChange = (val) => {\r\n\t\tsetPage(val);\r\n\t};\r\n\t// 页容量变化\r\n\tconst handleLimitChange = (val) => {\r\n\t\tsetLimit(val);\r\n\t};\r\n\t// 每一个歌单元素\r\n\tconst lis = list.map((l) => <Item key={l.id} {...l}></Item>);\r\n\treturn (\r\n\t\t<div className=\"playlist-container\">\r\n\t\t\t<Category />\r\n\t\t\t<ul className=\"ul-wrapper\">{lis}</ul>\r\n\t\t\t{!loading ? (\r\n\t\t\t\t<div className=\"pagination-wrapper\">\r\n\t\t\t\t\t<Pagination\r\n\t\t\t\t\t\ttotal={total}\r\n\t\t\t\t\t\tcurrentPage={page}\r\n\t\t\t\t\t\tonPageChange={handlePageChange}\r\n\t\t\t\t\t\tshowSizeChanger\r\n\t\t\t\t\t\tpageSize={limit}\r\n\t\t\t\t\t\tpageSizeOpts={[15, 35, 70]}\r\n\t\t\t\t\t\tonPageSizeChange={handleLimitChange}\r\n\t\t\t\t\t></Pagination>\r\n\t\t\t\t</div>\r\n\t\t\t) : null}\r\n\t\t\t<Spin\r\n\t\t\t\tspinning={loading}\r\n\t\t\t\ttip=\"loading...\"\r\n\t\t\t\tsize=\"large\"\r\n\t\t\t\tstyle={{\r\n\t\t\t\t\tposition: \"fixed\",\r\n\t\t\t\t\ttop: \"50%\",\r\n\t\t\t\t\tleft: \"50%\",\r\n\t\t\t\t\ttransform: \"translate(-50%, -50%)\",\r\n\t\t\t\t\tzIndex: \"9999\",\r\n\t\t\t\t}}\r\n\t\t\t></Spin>\r\n\t\t</div>\r\n\t);\r\n}\r\n","export default __webpack_public_path__ + \"static/media/loading.4c0ea1e7.svg\";"],"sourceRoot":""}