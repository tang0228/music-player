{"version":3,"sources":["assets/loading.svg","pages/Find/modules/item.module.less","pages/Find/modules/Item.jsx","pages/Find/modules/CatSelect.jsx","pages/Find/modules/Category.jsx","pages/Find/modules/PlayList.jsx"],"names":["module","exports","connect","state","curSongId","dispatch","setCurSongId","setCurSongIdAction","addSongs","addSongListAction","props","className","style","height","debounce","placeholder","width","src","loadingUrl","coverImgUrl","alt","to","id","title","onClick","getPlayListDetail","then","res","code","Toast","success","content","duration","list","playlist","tracks","map","t","url","song","bind","parseInt","playCount","description","creator","userId","nickname","iconArr","CatSelect","categories","history","useHistory","location","useLocation","cat","qs","parse","search","useState","showSelect","setShowSelect","openSelect","useCallback","handleCatClick","e","name","target","outerText","catChange","push","window","encodeURIComponent","items","Array","isArray","c","i","subCat","s","type","transferCat","sub","newCat","key","category","forEach","Category","setCategories","setCat","useEffect","a","getPlayListCat","PlayList","limit","setLimit","page","setPage","setList","total","setTotal","loading","setLoading","getPlaylist","offset","playlists","utils","unique","handlePageChange","val","handleLimitChange","lis","l","currentPage","onPageChange","showSizeChanger","pageSize","pageSizeOpts","onPageSizeChange","spinning","tip","size","position","top","left","transform","zIndex"],"mappings":"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","file":"static/js/25.71fb5fbf.chunk.js","sourcesContent":["export default __webpack_public_path__ + \"static/media/loading.4c0ea1e7.svg\";","// extracted by mini-css-extract-plugin\nmodule.exports = {\"item-wrapper\":\"item_item-wrapper__3YHMT\"};","import React from \"react\";\r\nimport LazyLoad from \"react-lazyload\";\r\nimport style from \"./item.module.less\";\r\nimport { Link } from \"react-router-dom\";\r\nimport loadingUrl from \"@/assets/loading.svg\";\r\nimport { getPlayListDetail } from \"@/services/apis\";\r\nimport { addSongListAction } from \"@/store/actions/song\";\r\nimport { setCurSongIdAction } from \"@/store/actions/curSongId\";\r\nimport { connect } from \"react-redux\";\r\nimport { Toast } from \"@douyinfe/semi-ui\";\r\n\r\nconst mapStateToProps = (state) => {\r\n\treturn {\r\n\t\tcurSongId: state.curSongId,\r\n\t};\r\n};\r\n\r\nconst mapDispatchToProps = (dispatch) => {\r\n\treturn {\r\n\t\tsetCurSongId: (...args) => dispatch(setCurSongIdAction(...args)),\r\n\t\taddSongs: (...args) => dispatch(addSongListAction(...args))\r\n\t};\r\n};\r\n\r\nfunction Item(props) {\r\n\tconst { setCurSongId, addSongs } = props;\r\n\t// 添加歌单到播放列表\r\n\tconst addSongList = () => {\r\n\t\tgetPlayListDetail({ id: props.id }).then(res => {\r\n\t\t\tif (res.code === 200) {\r\n\t\t\t\tToast.success({\r\n\t\t\t\t\tcontent: \"成功添加歌单到播放列表\",\r\n\t\t\t\t\tduration: 2\r\n\t\t\t\t});\r\n\t\t\t\tconst list = res.playlist.tracks.map(t => ({\r\n\t\t\t\t\tid: t.id,\r\n\t\t\t\t\turl: 'https://music.163.com/song/media/outer/url?id=' + t.id + '.mp3',\r\n\t\t\t\t\tsong: t\r\n\t\t\t\t}));\r\n\t\t\t\taddSongs(list);\r\n\t\t\t\tsetCurSongId(list[0].id);\r\n\t\t\t}\r\n\t\t})\r\n\t}\r\n\treturn (\r\n\t\t<li className={style[\"item-wrapper\"]}>\r\n\t\t\t<div\r\n\t\t\t\tclassName=\"item-content\"\r\n\t\t\t>\r\n\t\t\t\t<LazyLoad height={140} debounce={500} placeholder={<img width=\"100%\" height=\"100%\" src={loadingUrl} />}>\r\n\t\t\t\t\t<img src={props.coverImgUrl} alt=\"\" />\r\n\t\t\t\t</LazyLoad>\r\n\t\t\t\t<Link to={`/find/playlist/detail?id=${props.id}`}>\r\n\t\t\t\t\t<span className=\"mask\"></span>\r\n\t\t\t\t</Link>\r\n\t\t\t\t<div className=\"bottom\">\r\n\t\t\t\t\t<i className=\"icon-heard\"></i>\r\n\t\t\t\t\t<i className=\"icon-play\" title=\"播放\" onClick={addSongList.bind(null, props.id)}></i>\r\n\t\t\t\t\t<span className=\"play-nums\">\r\n\t\t\t\t\t\t{parseInt(props.playCount / 10000)}万\r\n\t\t\t\t\t</span>\r\n\t\t\t\t</div>\r\n\r\n\t\t\t</div>\r\n\t\t\t<p className=\"desc\">\r\n\t\t\t\t<Link to={`/find/playlist/detail?id=${props.id}`}>{props.description}</Link>\r\n\t\t\t</p>\r\n\t\t\t<p className=\"user\">\r\n\t\t\t\t<span className=\"text\">by</span>\r\n\t\t\t\t<Link className=\"name\" to={`/user/home?uid=${props.creator.userId}`}>{props.creator.nickname}</Link>\r\n\t\t\t</p>\r\n\t\t</li>\r\n\t);\r\n}\r\n\r\nexport default connect(mapStateToProps, mapDispatchToProps)(Item);\r\n","import React, { useState, useCallback } from \"react\";\r\nimport { useHistory, useLocation } from \"react-router-dom\";\r\nimport qs from \"query-string\";\r\nimport {\r\n  IconChevronDown,\r\n  IconMusic,\r\n  IconGlobeStroke,\r\n  IconCheckList,\r\n  IconHourglass,\r\n  IconLikeHeart,\r\n} from \"@douyinfe/semi-icons\";\r\nimport { Button } from \"@douyinfe/semi-ui\";\r\nimport \"./catSelect.less\";\r\n\r\nconst iconArr = [\r\n  <IconGlobeStroke />,\r\n  <IconCheckList />,\r\n  <IconHourglass />,\r\n  <IconLikeHeart />,\r\n  <IconMusic />,\r\n];\r\n\r\nexport default function CatSelect(props) {\r\n  const { categories } = props;\r\n  const history = useHistory();\r\n  const location = useLocation();\r\n  const cat = qs.parse(location.search).cat;\r\n  const [showSelect, setShowSelect] = useState(false); // 是否打开下拉框\r\n  const openSelect = useCallback(() => {\r\n    setShowSelect(!showSelect);\r\n  }, [showSelect]);\r\n\r\n  const handleCatClick = useCallback(\r\n      (e) => {\r\n          let name = e.target.outerText;\r\n          if(name === \"全部风格\") {\r\n            props.catChange && props.catChange(\"\");\r\n            history.push(`/find/playlist`)\r\n          } else {\r\n            props.catChange && props.catChange(name);\r\n            history.push(`/find/playlist?cat=${window.encodeURIComponent(name)}`)\r\n          }\r\n      },\r\n      [],\r\n  )\r\n\r\n  const items =\r\n    Array.isArray(categories) &&\r\n    categories.map((c, i) => (\r\n      <dl className=\"select-row\" key={c.name}>\r\n        <dt className=\"title\">\r\n          {iconArr[i]}\r\n          <span className=\"text\">{c.name}</span>\r\n        </dt>\r\n        <dd className={\"item\"}>\r\n          {c.subCat.map((s) => (\r\n            <span key={s.name}>\r\n              <span className={cat === s.name ? 'cat selected' : 'cat'} onClick={handleCatClick}>{s.name}</span>\r\n              <span className=\"line\">|</span>\r\n            </span>\r\n          ))}\r\n        </dd>\r\n      </dl>\r\n    ));\r\n  return (\r\n    <div className=\"select-wrapper\">\r\n      <div className=\"select-btn\" onClick={openSelect}>\r\n        <span className=\"select-title\">选择分类</span>\r\n        <IconChevronDown />\r\n      </div>\r\n      {showSelect ? (\r\n        <div className=\"select-content\">\r\n          <div className=\"all\">\r\n            <Button type=\"primary\" onClick={handleCatClick}>全部风格</Button>\r\n          </div>\r\n          {items}\r\n        </div>\r\n      ) : null}\r\n    </div>\r\n  );\r\n}\r\n","import React, { useEffect, useState, useCallback} from 'react';\r\nimport \"./category.less\";\r\nimport { getPlayListCat } from \"../../../services/apis\";\r\nimport CatSelect from './CatSelect';\r\nimport qs from \"query-string\";\r\nimport { useLocation } from \"react-router-dom\";\r\n\r\nfunction transferCat(cat, sub) {\r\n    let newCat = [];\r\n    for (const key in cat) {\r\n        newCat.push({\r\n            name: cat[key],\r\n            category: key,\r\n            subCat: [],\r\n        })\r\n    }\r\n    Array.isArray(sub) && sub.forEach((c, i) => {\r\n        newCat[c.category].subCat.push(c);\r\n    });\r\n    return newCat;\r\n}\r\n\r\nexport default function Category() {\r\n    const location = useLocation();\r\n    const [categories, setCategories] = useState();\r\n    const [cat, setCat] = useState(qs.parse(location.search).cat);\r\n    useEffect(() => {\r\n        (async () => {\r\n            const res = await getPlayListCat();\r\n            const newCat = transferCat(res.categories, res.sub);\r\n            setCategories(newCat);\r\n        })();\r\n        return () => {\r\n        }\r\n    }, []);\r\n\r\n    const catChange = useCallback(\r\n        (name) => {\r\n            setCat(name);\r\n        },\r\n        [],\r\n    )\r\n    return (\r\n        <div className=\"cat-container\">\r\n            <div className=\"cat-select\">\r\n                <span className=\"cat-title\">{cat ? cat : '全部'}</span>\r\n                <CatSelect categories={categories} catChange={catChange} />\r\n            </div>\r\n        </div>\r\n    )\r\n}\r\n","import React, { useEffect, useState, useCallback } from \"react\";\r\nimport { getPlaylist } from \"../../../services/apis\";\r\nimport { useLocation } from \"react-router-dom\";\r\nimport Item from \"./Item\";\r\nimport Category from \"./Category\";\r\nimport { Pagination, Spin } from \"@douyinfe/semi-ui\";\r\nimport \"./playlist.less\";\r\nimport utils from \"../../../utils\";\r\nimport qs from \"query-string\";\r\n\r\nexport default function PlayList() {\r\n\tconst [limit, setLimit] = useState(35); // 页容量\r\n\tconst [page, setPage] = useState(1); // 页码\r\n\tconst [list, setList] = useState([]); // 歌单列表\r\n\tconst [total, setTotal] = useState(0); // 歌单总数\r\n\tconst [loading, setLoading] = useState(false); // 加载中\r\n\tconst location = useLocation();\r\n\tconst cat = qs.parse(location.search).cat || \"\";\r\n\t// 获取歌单\r\n\tuseEffect(() => {\r\n\t\t(async () => {\r\n\t\t\tsetLoading(true);\r\n\t\t\tconst res = await getPlaylist({\r\n\t\t\t\toffset: (page - 1) * limit,\r\n\t\t\t\tlimit,\r\n\t\t\t\tcat,\r\n\t\t\t});\r\n\t\t\tif (res.code === 200) {\r\n\t\t\t\t// 去重\r\n\t\t\t\tconst playlists = utils.unique(res.playlists);\r\n\t\t\t\tsetList(playlists);\r\n\t\t\t\tsetTotal(res.total);\r\n\t\t\t\tsetLoading(false);\r\n\t\t\t}\r\n\t\t})();\r\n\t\treturn () => { };\r\n\t}, [page, limit, cat]);\r\n\t// 页码变化\r\n\tconst handlePageChange = useCallback((val) => {\r\n\t\tsetPage(val);\r\n\t}, []);\r\n\t// 页容量变化\r\n\tconst handleLimitChange = useCallback((val) => {\r\n\t\tsetLimit(val);\r\n\t}, []);\r\n\t// 每一个歌单元素\r\n\tconst lis = list.map((l) => <Item key={l.id} {...l}></Item>);\r\n\treturn (\r\n\t\t<div className=\"playlist-container\">\r\n\t\t\t<Category />\r\n\t\t\t<ul className=\"ul-wrapper\">{lis}</ul>\r\n\t\t\t{!loading ? (\r\n\t\t\t\t<div className=\"pagination-wrapper\">\r\n\t\t\t\t\t<Pagination\r\n\t\t\t\t\t\ttotal={total}\r\n\t\t\t\t\t\tcurrentPage={page}\r\n\t\t\t\t\t\tonPageChange={handlePageChange}\r\n\t\t\t\t\t\tshowSizeChanger\r\n\t\t\t\t\t\tpageSize={limit}\r\n\t\t\t\t\t\tpageSizeOpts={[15, 35, 70]}\r\n\t\t\t\t\t\tonPageSizeChange={handleLimitChange}\r\n\t\t\t\t\t></Pagination>\r\n\t\t\t\t</div>\r\n\t\t\t) : null}\r\n\t\t\t<Spin\r\n\t\t\t\tspinning={loading}\r\n\t\t\t\ttip=\"loading...\"\r\n\t\t\t\tsize=\"large\"\r\n\t\t\t\tstyle={{\r\n\t\t\t\t\tposition: \"fixed\",\r\n\t\t\t\t\ttop: \"50%\",\r\n\t\t\t\t\tleft: \"50%\",\r\n\t\t\t\t\ttransform: \"translate(-50%, -50%)\",\r\n\t\t\t\t\tzIndex: \"9999\",\r\n\t\t\t\t}}\r\n\t\t\t></Spin>\r\n\t\t</div>\r\n\t);\r\n}\r\n"],"sourceRoot":""}